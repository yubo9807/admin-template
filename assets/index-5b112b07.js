import{g as C,d as b,G as I,W as V,q as w,Q as k,a1 as E,T as v,a2 as L,_ as N,r as i,o as R,e as B,w as r,b as s,B as D}from"./index-f0fda0f1.js";const U=()=>{const e=C(),t=e.props,u=b(!1),l=I({name:"",key:"",menuId:""}),g={name:{required:!0,message:"请输入接口名称",trigger:"blur"},key:{required:!0,message:"请输入Key",trigger:"blur"}};async function _(){e.refs.formRef.validate(async o=>{o&&(t.type===0?m():d())})}async function m(){const a=k(l),[o]=await E(a);o||(v.success("添加成功"),u.value=!1,e.emit("success"))}async function d(){const a=k({id:t.need.id,...l}),[o]=await L(a);o||(v.success("修改成功"),u.value=!1,e.emit("success"))}const p=V("getRoleList"),c=V("getMenuList"),y=b([]),f=b([]);w(()=>u.value,a=>{if(a){if(y.value=p(),f.value=c(),t.type===0&&(l.menuId=t.need.menuId),t.type===1)for(const o in l)l[o]=t.need[o]}else{e.refs.formRef.resetFields();for(const o in l)l[o]=""}});function n(a){l.menuId=a.id}return{visible:u,menuList:f,form:l,rules:g,submit:_,treeNodeClick:n}},q={props:{type:{type:Number,default:0},need:{type:Object,default:()=>({})}},setup:U};function M(e,t,u,l,g,_){const m=i("el-input"),d=i("el-form-item"),p=i("el-tree-select"),c=i("el-button"),y=i("el-form"),f=i("el-dialog");return R(),B(f,{modelValue:e.visible,"onUpdate:modelValue":t[3]||(t[3]=n=>e.visible=n),width:"400px"},{default:r(()=>[s(y,{ref:"formRef","label-width":"100px",model:e.form,rules:e.rules},{default:r(()=>[s(d,{label:"元素名称",prop:"name"},{default:r(()=>[s(m,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=n=>e.form.name=n)},null,8,["modelValue"])]),_:1}),s(d,{label:"Key",prop:"key"},{default:r(()=>[s(m,{modelValue:e.form.key,"onUpdate:modelValue":t[1]||(t[1]=n=>e.form.key=n)},null,8,["modelValue"])]),_:1}),s(d,{label:"父级菜单"},{default:r(()=>[s(p,{modelValue:e.form.menuId,"onUpdate:modelValue":t[2]||(t[2]=n=>e.form.menuId=n),data:e.menuList,clearable:"",props:{children:"children",label:"title",value:"id"},"render-after-expand":!1,disabled:u.type===0,onNodeClick:e.treeNodeClick},null,8,["modelValue","data","disabled","onNodeClick"])]),_:1}),s(d,null,{default:r(()=>[s(c,{type:"primary",onClick:e.submit},{default:r(()=>t[4]||(t[4]=[D("确认")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}const j=N(q,[["render",M]]);export{j as default};
