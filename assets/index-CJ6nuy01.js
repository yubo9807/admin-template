import{d as y,D as _,T as g,p as E,g as v,N as C,U as D,P as V,V as F,_ as N,r as i,o as k,e as B,w as a,b as u,A as M}from"./index-CUJUVGxI.js";const w=()=>{const e=v(),l=e.props,s=y(!1),m=y([]),n=_({name:"",title:"",parent:""}),b={title:{required:!0,message:"请输入菜单名称",trigger:"blur"},name:{required:!0,message:"请输入Name",trigger:"blur"}};async function d(){e.refs.formRef.validate(async t=>{t&&(l.type===0?r():p())})}async function r(){const o=C(n),[t]=await D(o);t||(s.value=!1,V.success("添加成功"),e.emit("success"))}async function p(){const o=C({id:l.need.id,...n}),[t]=await F(o);t||(s.value=!1,V.success("修改成功"),e.emit("success"))}const f=g("getMenuList");E(()=>s.value,o=>{if(o){if(m.value=f(),l.type===1)for(const t in n)n[t]=l.need[t]}else{e.refs.formRef.resetFields();for(const t in n)n[t]=""}});function c(o){n.parent=o.id}return{visible:s,menuList:m,form:n,rules:b,submit:d,treeNodeClick:c}},U={props:{type:{type:Number,default:0},need:{type:Object,default:()=>({})}},setup:w};function A(e,l,s,m,n,b){const d=i("el-input"),r=i("el-form-item"),p=i("el-tree-select"),f=i("el-button"),c=i("el-form"),o=i("el-dialog");return k(),B(o,{modelValue:e.visible,"onUpdate:modelValue":l[3]||(l[3]=t=>e.visible=t),width:"400px",title:s.type===1?"修改菜单":"新增菜单"},{default:a(()=>[u(c,{ref:"formRef","label-width":"100px",model:e.form,rules:e.rules},{default:a(()=>[u(r,{label:"菜单名称",prop:"title"},{default:a(()=>[u(d,{modelValue:e.form.title,"onUpdate:modelValue":l[0]||(l[0]=t=>e.form.title=t)},null,8,["modelValue"])]),_:1}),u(r,{label:"Name",prop:"name"},{default:a(()=>[u(d,{modelValue:e.form.name,"onUpdate:modelValue":l[1]||(l[1]=t=>e.form.name=t),placeholder:"保证唯一，对应前端路由设置 name"},null,8,["modelValue"])]),_:1}),u(r,{label:"父级菜单"},{default:a(()=>[u(p,{modelValue:e.form.parent,"onUpdate:modelValue":l[2]||(l[2]=t=>e.form.parent=t),data:e.menuList,clearable:"",props:{children:"children",label:"title",value:"id"},"render-after-expand":!1,onNodeClick:e.treeNodeClick},null,8,["modelValue","data","onNodeClick"])]),_:1}),u(r,null,{default:a(()=>[u(f,{type:"primary",onClick:e.submit},{default:a(()=>l[4]||(l[4]=[M("确认")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}const R=N(U,[["render",A]]);export{R as default};
