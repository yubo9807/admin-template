var L=Object.defineProperty;var k=e=>{throw TypeError(e)};var N=(e,t,n)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var D=(e,t,n)=>N(e,typeof t!="symbol"?t+"":t,n),F=(e,t,n)=>t.has(e)||k("Cannot "+n);var h=(e,t,n)=>(F(e,t,"read from private field"),n?n.call(e):t.get(e)),w=(e,t,n)=>t.has(e)?k("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),E=(e,t,n,r)=>(F(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);import{a0 as S,g as v,N as B,n as $,d as T,E as V,a1 as H,P as K,Q as M,Y as U,_ as q,r as c,o as z,c as P,b as a,w as i,H as Q,A as g,t as R}from"./index-CUJUVGxI.js";import Y from"./index-DIfgfXqq.js";import j from"./index-DZG7OKB_.js";import{d as G}from"./date-CMk_DNDl.js";import{I as J}from"./init-table-DeU0H5lE.js";const O={url:""};var f,m;class W extends J{constructor(){super(O,S);w(this,f,null);w(this,m,null);D(this,"initData",async()=>{const n=B({roleId:h(this,m).roleId,menuId:h(this,m).menuId,...this.form}),[r,d]=await S(n);if(r)return;this.tableData.value=d.data;const _=h(this,f).refs.tableEl,I=d.data.filter(u=>u.selected);$(()=>{I.forEach(u=>_.toggleRowSelection(u))})});E(this,f,v()),E(this,m,h(this,f).props)}}f=new WeakMap,m=new WeakMap;const X=()=>{const e=v(),t=e.proxy,n=e.props,r=T(0),d=T({});function _(){r.value=0,d.value={menuId:n.menuId},e.refs.dialogInterface.visible=!0}function I(l){const{id:s,name:p,method:b,url:y,menuId:o}=l;r.value=1,d.value={id:s,name:p,method:b,url:y,menuId:o},e.refs.dialogInterface.visible=!0}function u(l){V.confirm("确认删除该接口","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{const[s,p]=await H({id:l.id});s||(K.success("删除成功"),t.initData())}).catch(()=>{})}async function C(l){const s=l.map(o=>o.id),p=t.tableData.filter(o=>!s.includes(o.id)).map(o=>o.id),b=B({tableType:"interface",roleId:n.roleId,contactIdList:s,deleteIdList:p}),[y]=await M(b);y||t.initData()}return{dialogInterfaceType:r,dialogInterfaceNeed:d,addInterface:_,modifyInterface:I,deleteInterface:u,select:C}},Z={components:{LayoutSearchHeader:U,TableAddBtn:Y,DialogInterface:j},props:{roleId:{type:[String,Number],required:!0},menuId:{type:String,default:""}},setup:()=>({dateFormater:G,...new W,...X()})},x={class:"menu-list"};function ee(e,t,n,r,d,_){const I=c("el-input"),u=c("el-button"),C=c("LayoutSearchHeader"),l=c("el-table-column"),s=c("el-link"),p=c("el-table"),b=c("TableAddBtn"),y=c("DialogInterface");return z(),P("div",x,[a(C,{"right-width":"340px"},{left:i(()=>[a(I,{modelValue:e.form.url,"onUpdate:modelValue":t[0]||(t[0]=o=>e.form.url=o),placeholder:"请输入接口地址",onKeyup:Q(e.search,["enter"]),onClear:e.search},null,8,["modelValue","onKeyup","onClear"])]),right:i(()=>[a(u,{type:"primary",onClick:e.search},{default:i(()=>t[1]||(t[1]=[g("查询")])),_:1},8,["onClick"]),a(u,{onClick:e.reset},{default:i(()=>t[2]||(t[2]=[g("重置")])),_:1},8,["onClick"])]),_:1}),a(p,{ref:"tableEl",data:e.tableData,onSelect:e.select,onSelectAll:e.select},{default:i(()=>[a(l,{type:"selection",width:"40",label:""}),a(l,{type:"index",label:"序号",width:"60"}),a(l,{label:"接口名称",prop:"name"}),a(l,{label:"Method",prop:"method"}),a(l,{label:"Url",prop:"url"}),a(l,{label:"更新时间"},{default:i(o=>[g(R(e.dateFormater((o.row.updateTime||o.row.createTime)*1e3)),1)]),_:1}),a(l,{label:"操作",fixed:"right",width:"100"},{default:i(o=>[a(s,{onClick:A=>e.modifyInterface(o.row)},{default:i(()=>t[3]||(t[3]=[g("修改")])),_:2},1032,["onClick"]),a(s,{type:"danger",onClick:A=>e.deleteInterface(o.row)},{default:i(()=>t[4]||(t[4]=[g("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelect","onSelectAll"]),a(b,{onClick:e.addInterface},null,8,["onClick"]),a(y,{ref:"dialogInterface",type:e.dialogInterfaceType,need:e.dialogInterfaceNeed,onSuccess:e.initData},null,8,["type","need","onSuccess"])])}const se=q(Z,[["render",ee]]);export{se as default};
