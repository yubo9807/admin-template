var v=Object.defineProperty;var h=(t,e,i)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var k=(t,e,i)=>h(t,typeof e!="symbol"?e+"":e,i);import{_ as D}from"./index.vue_vue_type_script_setup_true_lang-CtfEKEav.js";import{I as R}from"./init-table-Ca7UW4O4.js";import{d as E,N as B,J as F,K as T,E as w,a4 as x,P as I,_ as L,r,o as N,e as S,w as l,b as o,H as V,A as m}from"./index-B4TZ5wGE.js";const K={name:"SystemRoles",components:{DialogEdit:D},setup(){const t={role:""};class e extends R{constructor(){super(t);k(this,"initData",async()=>{const p=B(this.form),[C,d]=await F(p);C?this.tableData.value=[]:this.tableData.value=T(d.data||[])});this.initData()}}const i=new e,n=E(),f=E("add"),y=E({}),u=E({});function c(){n.value.visible=!0,y.value={},u.value={},f.value="add"}function g(a){f.value="modify",y.value={role:a.role,remark:a.remark,parent:a.parent},u.value={id:a.id},n.value.visible=!0}async function s(a){let _=a.children.length===0?"确认删除该角色？":"删除该角色子级也会被删除，请确认操作！";w.confirm(_,"提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}).then(async()=>{const[p]=await x({id:a.id});p||(I.success("删除成功"),i.initData())}).catch(()=>{})}return{...i,dialogEditRef:n,dialogEditType:f,dialogEditInfo:y,dialogEditNeed:u,addRole:c,modifyRole:g,deleteRole:s}}};function M(t,e,i,n,f,y){const u=r("el-input"),c=r("el-button"),g=r("LayoutSearch"),s=r("el-table-column"),a=r("el-link"),_=r("el-table"),p=r("DialogEdit"),C=r("LayoutContainer");return N(),S(C,null,{default:l(()=>[o(g,{"right-width":"320px"},{left:l(()=>[o(u,{modelValue:t.form.role,"onUpdate:modelValue":e[0]||(e[0]=d=>t.form.role=d),placeholder:"请输入角色",onKeyup:V(t.search,["enter"]),onClear:t.search},null,8,["modelValue","onKeyup","onClear"])]),right:l(()=>[o(c,{type:"primary",onClick:t.search},{default:l(()=>e[1]||(e[1]=[m("查询")])),_:1},8,["onClick"]),o(c,{onClick:t.reset},{default:l(()=>e[2]||(e[2]=[m("重置")])),_:1},8,["onClick"]),o(c,{type:"primary",onClick:n.addRole},{default:l(()=>e[3]||(e[3]=[m("新增")])),_:1},8,["onClick"])]),_:1}),o(_,{data:t.tableData,"row-key":"id","tree-props":{children:"children"}},{default:l(()=>[o(s,{type:"index",label:"序号",width:"60"}),o(s,{label:"角色",prop:"role"}),o(s,{label:"备注",prop:"remark"}),o(s,{label:"操作",fixed:"right",width:"100"},{default:l(({row:d})=>[o(a,{onClick:b=>n.modifyRole(d)},{default:l(()=>e[4]||(e[4]=[m("修改")])),_:2},1032,["onClick"]),o(a,{type:"danger",onClick:b=>n.deleteRole(d)},{default:l(()=>e[5]||(e[5]=[m("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),o(p,{ref:"dialogEditRef",type:n.dialogEditType,info:n.dialogEditInfo,need:n.dialogEditNeed,onSuccess:t.initData},null,8,["type","info","need","onSuccess"])]),_:1})}const U=L(K,[["render",M]]);export{U as default};
