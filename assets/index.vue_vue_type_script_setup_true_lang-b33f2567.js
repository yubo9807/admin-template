import{A as E,d as _,G as L,J as j,q,r as i,o as F,e as M,w as n,b as l,B as O,aa as z,ab as A,Q as y,T as b,ac as G,ad as J,M as Q,N as D}from"./index-f0fda0f1.js";const I=E({__name:"index",props:{type:{},info:{},need:{}},emits:["success"],setup(V,{expose:v,emit:k}){const s=V,r=_(!1),m=Object.freeze({role:"",remark:"",parent:""}),t=L(Object.assign({},m)),g={role:{required:!0,message:"请输入角色",trigger:"blur"}},u=j(),f=_([]);async function w(){const[a,e]=await Q({});a||(f.value=D(e.data))}function x(a){t.parent=a.id}q(()=>r.value,a=>{if(a){if(w(),s.type==="modify")for(const e in s.info)t[e]=s.info[e]}else{for(const e in t)t[e]=m[e];u.value.clearValidate()}});const c=k;function C(){u.value.validate(async a=>{a&&(s.type==="add"&&R(),s.type==="modify"&&N())})}async function R(){const[a]=await A(y(t));a||(b.success("添加成功"),r.value=!1,c("success"))}async function N(){const a=y({...s.need,...t}),[e]=await G(a);e||(b.success("修改成功"),r.value=!1,c("success"))}return v({visible:r}),(a,e)=>{const p=i("el-input"),d=i("el-form-item"),T=i("el-tree-select"),U=i("el-button"),B=i("el-dialog");return F(),M(B,{modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=o=>r.value=o),width:"400px",title:a.type==="add"?"新增角色":"修改角色"},{default:n(()=>[l(z(J),{ref_key:"formRef",ref:u,model:t,rules:g,"label-width":"100px"},{default:n(()=>[l(d,{label:"角色",prop:"role"},{default:n(()=>[l(p,{modelValue:t.role,"onUpdate:modelValue":e[0]||(e[0]=o=>t.role=o)},null,8,["modelValue"])]),_:1}),l(d,{label:"备注"},{default:n(()=>[l(p,{modelValue:t.remark,"onUpdate:modelValue":e[1]||(e[1]=o=>t.remark=o)},null,8,["modelValue"])]),_:1}),l(d,{label:"父级角色"},{default:n(()=>[l(T,{modelValue:t.parent,"onUpdate:modelValue":e[2]||(e[2]=o=>t.parent=o),data:f.value,clearable:"",props:{children:"children",label:"role",value:"id"},"render-after-expand":!1,onNodeClick:x},null,8,["modelValue","data"])]),_:1}),l(d,null,{default:n(()=>[l(U,{type:"primary",onClick:C},{default:n(()=>e[4]||(e[4]=[O("确认")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}});export{I as _};
